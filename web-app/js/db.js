zk.load('zul.inp',function(){zk._n='zul.db';try{zk._p=zk.$package(zk._n,false,true);
zul.db.Calendar=zk.$extends(zul.Widget,{_view:"day",$define:{value:_zkf=function(){this.rerender()},constraint:function(){var b=this._constraint||"";if(b.startsWith("between")){var a=b.indexOf("and",7);if(a<0&&zk.debugJS){zk.error("Unknown constraint: "+b)}this._beg=zDateFormat.parseDate(b.substring(7,a),"yyyyMMdd");this._end=zDateFormat.parseDate(b.substring(a+3),"yyyyMMdd");if(this._beg.getTime()>this._end.getTime()){var c=this._beg;this._beg=this._end;this._end=c}this._beg.setHours(0);this._beg.setMinutes(0);this._beg.setSeconds(0);this._beg.setMilliseconds(0);this._end.setHours(0);this._end.setMinutes(0);this._end.setSeconds(0);this._end.setMilliseconds(0)}else{if(b.startsWith("before")){this._end=zDateFormat.parseDate(b.substring(6),"yyyyMMdd");this._end.setHours(0);this._end.setMinutes(0);this._end.setSeconds(0);this._end.setMilliseconds(0)}else{if(b.startsWith("after")){this._beg=zDateFormat.parseDate(b.substring(5),"yyyyMMdd");this._beg.setHours(0);this._beg.setMinutes(0);this._beg.setSeconds(0);this._beg.setMilliseconds(0)}}}}},getFormat:function(){return this._fmt||"yyyy/MM/dd"},getZclass:function(){var a=this._zclass;return a!=null?a:"z-calendar"},today:function(){return zUtl.today()},bind_:function(){this.$supers("bind_",arguments);this._value?zDateFormat.parseDate(this._value,this.getFormat()):new Date();var e=this.$n("title"),a=this.$n("mid"),b=this.$n("ly"),c=this.$n("ry"),d=this.getZclass();jq(e).hover(function(){$(this).toggleClass(d+"-title-over")},function(){$(this).toggleClass(d+"-title-over")});this._markCal();this.domListen_(e,"onClick","_changeView").domListen_(a,"onClick","_choiceData").domListen_(b,"onClick","_doclickArrow").domListen_(c,"onClick","_doclickArrow").domListen_(a,"onMouseOver","_doMouseEffect").domListen_(a,"onMouseOut","_doMouseEffect")},unbind_:function(){var d=this.$n("title"),a=this.$n("mid"),b=this.$n("ly"),c=this.$n("ry");this.domUnlisten_(d,"onClick","_changeView").domUnlisten_(a,"onClick","_choiceData").domUnlisten_(b,"onClick","_doclickArrow").domUnlisten_(c,"onClick","_doclickArrow").domUnlisten_(a,"onMouseOver","_doMouseEffect").domUnlisten_(a,"onMouseOut","_doMouseEffect").$supers("unbind_",arguments)},_doclickArrow:function(a){var b=a.domTarget,c=b.id.indexOf("-ly")>0?-1:1;if(jq(b).hasClass(this.getZclass()+(c==-1?"-left-icon-disd":"-right-icon-disd"))){return}switch(this._view){case"day":this._shiftDate("m",c);break;case"month":this._shiftDate("y",c);break;case"year":this._shiftDate("y",c*10);break;case"decade":this._shiftDate("y",c*100);break}this.rerender()},_doMouseEffect:function(a){var b=a.domTarget.tagName=="TD"?a.domTarget:a.domTarget.parentNode,c=this.getZclass();if(jq(b).hasClass(c+"-disd")){return}if(jq(b).is("."+c+"-seld")){jq(b).removeClass(c+"-over");jq(b).toggleClass(c+"-over-seld")}else{jq(b).toggleClass(c+"-over")}},getTime:function(){return this._value?zDateFormat.parseDate(this._value,this.getFormat()):new Date()},_setTime:function(h,a,e,i,b){var j=this.getTime(),f=h!=null?h:j.getFullYear(),c=a!=null?a:j.getMonth(),g=e!=null?e:j.getDate();this._value=zDateFormat.formatDate(new Date(f,c,g),this.getFormat());this.fire("onChange",{value:this._value})},_choiceData:function(b){var e=b.domTarget;e=e.tagName=="TD"?e:e.parentNode;var f=jq(e).attr("_dt");if(e&&!jq(e).hasClass(this.getZclass()+"-disd")&&!isNaN(f)){var a=e,c=this.getTime();switch(this._view){case"day":var g=this.getTime();this._setTime(null,a._monofs!=null&&a._monofs!=0?c.getMonth()+a._monofs:null,f);var d=this.getTime();if(g.getYear()==d.getYear()&&g.getMonth()==d.getMonth()){this._markCal()}else{this.rerender()}break;case"month":this._setTime(null,f);this._setView("day");break;case"year":this._setTime(f);this._setView("month");break;case"decade":this._setTime(f);this._setView("year");break}}},_shiftDate:function(b,e){var d=this.getTime(),c=d.getFullYear(),f=d.getMonth(),a=d.getDate();switch(b){case"d":a=a+e;break;case"m":f=f+e;break;case"y":c=c+e;break;case"d":c=c+e;break}this._value=zDateFormat.formatDate(new Date(c,f,a),this.getFormat());this.fire("onChange",{value:this._value,shallClose:false})},_changeView:function(c){var b=this.$n("tm"),a=this.$n("ty"),d=this.$n("tyd");if(c.domTarget==b){this._setView("month")}else{if(c.domTarget==a){this._setView("year")}else{if(c.domTarget==d){this._setView("decade")}}}},_setView:function(a){if(a!=this._view){this._view=a;this.rerender()}},_invalid:function(g,b,e,c){var f=new Date(g,b,e,0,0,0,0);switch(this._constraint){case"no today":return c-f==0;break;case"no past":return(f-c)/86400000<0;break;case"no future":return(c-f)/86400000<0;break;default:var a=false;if(this._beg&&(a=(f-this._beg)/86400000<0)){return a}if(this._end&&(a=(this._end-f)/86400000<0)){return a}return a}},_markCal:function(){var c=this.getZclass(),x=this.getTime(),n=x.getMonth(),u=x.getDate(),f=x.getFullYear(),e=new Date(f,n+1,0).getDate(),l=new Date(f,n,0).getDate(),g=new Date(f,n,1).getDay()-zk.DOW_1ST,t=this.today();for(var r=0;r<12;++r){var s=this.$n("m"+r),h=this.$n("y"+r),i=f%10+1;if(s){if(n==r){jq(s).addClass(c+"-seld");jq(s).removeClass(c+"-over")}else{jq(s).removeClass(c+"-seld")}}if(h){if(i==r){jq(h).addClass(c+"-seld");jq(h).removeClass(c+"-over")}else{jq(h).removeClass(c+"-seld")}}}if(g<0){g+=7}for(var r=0,b=-g+1;r<6;++r){var p=this.$n("w"+r);if(p!=null){for(var q=0;q<7;++q,++b){g=b<=0?l+b:b<=e?b:b-e;if(q==0&&b>e){p.style.display="none"}else{if(q==0){p.style.display=""}var a=p.cells[q],w=b<=0?-1:b<=e?0:1,o=b==u;a.style.textDecoration="";a._monofs=w;jq(a).removeClass(c+"-over");jq(a).removeClass(c+"-over-seld");if(o){jq(a).addClass(c+"-seld")}else{jq(a).removeClass(c+"-seld")}if(this._invalid(f,n+w,g,t)){jq(a).addClass(c+"-disd")}else{jq(a).removeClass(c+"-disd")}jq(a).html('<a href="javascript:;">'+g+"</a>").attr("_dt",g)}}}}}});
zkreg('zul.db.Calendar');zk._m={};
zk._m['popup']=function(a){a.push('<table id="',this.uuid,'"',this.domAttrs_(),"</table>")};
;zk._m['default']=function(l){var a=this.uuid,r=this._view,c=this.getZclass(),f=this.getTime(),g=f.getMonth(),o=f.getDate(),q=f.getFullYear(),b=q-(q%10+1),p=zk.parseInt(q/100);l.push('<div id="',this.uuid,'"',this.domAttrs_(),'><table width="100%"',zUtl.cellps0,">",'<tr><td class="',c,'-tdl"><div  class="',c,'-left"><div id="',a,'-ly" class="',c,"-left-icon");if(r=="decade"&&p*100==1900){l.push(" ",c,"-left-icon-disd")}l.push('"></div></div></td>','<td><table class="',c,'-calctrl" width="100%" border="0" cellspacing="0" cellpadding="0">','<tr><td id="',a,'-title">');switch(r){case"day":l.push('<span id="',a,'-tm" class="',c,'-ctrler">',zk.SMON[g],'</span>, <span id="',a,'-ty" class="',c,'-ctrler">',q,"</span>");break;case"month":l.push('<span id="',a,'-tm" class="',c,'-ctrler">',zk.SMON[g],'</span>, <span id="',a,'-ty" class="',c,'-ctrler">',q,"</span>");break;case"year":l.push('<span id="',a,'-tyd" class="',c,'-ctrler">',b+1,"-",b+10,"</span>");break;case"decade":l.push('<span id="',a,'-tyd" class="',c,'-ctrler">',p*100,"-",p*100+99,"</span>");break}l.push("</td></tr></table></td>",'<td class="',c,'-tdr"><div class="',c,'-right"><div id="',a,'-ry" class="',c,"-right-icon");if(r=="decade"&&p*100==2000){l.push(" ",c,"-right-icon-disd")}l.push('"></div></div></td></tr>');switch(r){case"day":l.push('<tr><td colspan="3"><table id="',a,'-mid" class="',c,'-calday" width="100%" border="0" cellspacing="0" cellpadding="0">','<tr class="',c,'-caldow">');var n=(7-zk.DOW_1ST)%7,e=(6+n)%7;for(var i=0;i<7;++i){l.push("<td");if(i==n||i==e){l.push(' style="color:red"')}l.push(">"+zk.S2DOW[i]+"</td>")}l.push("</tr>");for(var i=0;i<6;++i){l.push('<tr class="',c,'-caldayrow" id="',a,"-w",i,'" >');for(var h=0;h<7;++h){l.push("<td></td>")}l.push("</tr>")}l.push("</table></td></tr>");break;case"month":l.push('<tr><td colspan="3" ><table id="',a,'-mid" class="',c,'-calmon" width="100%" border="0" cellspacing="0" cellpadding="0">');for(var i=0;i<12;++i){if(!(i%4)){l.push("<tr>")}l.push('<td id="',a,"-m",i,'"_dt="',i,'"><a href="javascript:;">',zk.SMON[i]+"</a></td>");if(!((i+1)%4)){l.push("</tr>")}}l.push("</table></td></tr>");break;case"year":l.push('<tr><td colspan="3" ><table id="',a,'-mid" class="',c,'-calyear" width="100%" border="0" cellspacing="0" cellpadding="0">');for(var i=0;i<12;++i){if(!(i%4)){l.push("<tr>")}l.push('<td _dt="',b,'" id="',a,"-y",i,'"',(i==0||i==11)?' style="color:gray;"':"",' ><a href="javascript:;">',b,"</a></td>");if(!((i+1)%4)){l.push("</tr>")}b++}l.push("</table></td></tr>");break;case"decade":l.push('<tr><td colspan="3" ><table id="',a,'-mid" class="',c,'-calyear" width="100%" border="0" cellspacing="0" cellpadding="0">');var s=p*100-10;for(var i=0;i<12;++i,s+=10){if(!(i%4)){l.push("<tr>")}if(s<1900||s>2090){l.push("<td>&nbsp;</td>");if(i+1==12){l.push("</tr>")}continue}l.push('<td _dt="',s,'" id="',a,"-de",i,'" class="',(q>=s&&q<=(s+9))?c+"-seld":"",'"',' ><a href="javascript:;"',(i==0||i==11)?'style="color:gray;"':"",">",s,"-<br />",s+9,"</a></td>");if(!((i+1)%4)){l.push("</tr>")}}l.push("</tr></table></td></tr>");break}l.push("</table></div>")};
;zkmld(zk._p.Calendar,zk._m);zul.db.Datebox=zk.$extends(zul.inp.FormatWidget,{_buttonVisible:true,_lenient:true,$init:(function(){function a(){this._pop=new zul.db.CalendarPop();this._tm=new zul.db.CalendarTime();this.appendChild(this._pop);this.appendChild(this._tm)}return function(){this.$supers("$init",arguments);this.$afterInit(a);this.listen({onChange:this},-1000)}})(),$define:{buttonVisible:function(a){var b=this.$n("btn");if(b){a?jq(b).show():jq(b).hide();this.onSize()}},format:function(){if(this._pop){this._pop.setFormat(this._format);if(this._value){this._value=this._pop.getTime()}}var a=this.getInputNode();if(a){a.value=this.coerceToString_(this._value)}},constraint:function(a){if(typeof a=="string"&&a.charAt(0)!="["){this._cst=new zul.inp.SimpleDateConstraint(a)}else{this._cst=a}if(this._cst){delete this._lastRawValVld}if(this._pop){this._pop.setConstraint(this._constraint);this._pop.rerender()}},lenient:null},setValue:function(c){var b;if(c){b=[];for(var a=arguments.length;--a>0;){b.unshift(arguments[a])}b.unshift((typeof c=="string")?this.coerceFromString_(c):c)}else{b=arguments}this.$supers("setValue",b)},onSize:_zkf=function(){var a=this.getWidth();if(!a||a.indexOf("%")!=-1){this.getInputNode().style.width=""}this.syncWidth();this._auxb.fixpos()},onShow:_zkf,getZclass:function(){var a=this._zclass;return a!=null?a:"z-datebox"},getRawText:function(){return this.coerceToString_(this._value)},getTimeFormat:function(){var c=this._format,a=c.indexOf("a"),d=c.indexOf("h"),h=c.indexOf("K"),k=c.indexOf("HH"),b=c.indexOf("k"),e=c.indexOf("m"),l=c.indexOf("s"),i=a>-1,j=i?d>-1||h>-1:false;if(j){var g=d<h?"a KK":"a hh";return g+(e>-1?":mm":"")+(l>-1?":ss":"")}else{var g=k<b?"kk":k>-1?"HH":"";return g+(e>-1?":mm":"")+(l>-1?":ss":"")}},getDateFormat:function(){return this._format.replace(/[ahKHksm]/g,"")},setOpen:function(b){var a=this.$n("pp");if(a){if(!jq(a).zk.isVisible()){this._pop.open()}else{this._pop.close()}}},coerceFromString_:function(b){if(b){var a=zDateFormat.parseDate(b,this.getFormat(),!this._lenient);if(!a){return{error:zMsgFormat.format(msgzul.DATE_REQUIRED+this._format)}}return a}else{return b}},coerceToString_:function(a){return a?zDateFormat.formatDate(a,this.getFormat()):""},getInputNode:function(){return this.$n("real")},syncWidth:function(){var e=this.$n();if(!zk(e).isRealVisible()||(!this._inplace&&!e.style.width)){return}if(this._buttonVisible&&this._inplace){if(!e.style.width){var c=jq(e),f=this.getInplaceCSS();c.removeClass(f);if(zk.opera){e.style.width=jq.px(zk(e).revisedWidth(e.clientWidth)+zk(e).borderWidth())}else{e.style.width=jq.px(zk(e).revisedWidth(e.offsetWidth))}c.addClass(f)}}var b=zk.opera?zk(e).revisedWidth(e.clientWidth)+zk(e).borderWidth():zk(e).revisedWidth(e.offsetWidth),a=this.$n("btn"),d=this.getInputNode();d.style.width=jq.px(zk(d).revisedWidth(b-(a?a.offsetWidth:0)))},doFocus_:function(a){var b=this.$n();if(this._inplace){b.style.width=jq.px(zk(b).revisedWidth(b.offsetWidth))}this.$supers("doFocus_",arguments);if(this._inplace){if(jq(b).hasClass(this.getInplaceCSS())){jq(b).removeClass(this.getInplaceCSS());this.onSize()}}if(this._readonly&&this._pop){this._pop.open()}},doBlur_:function(a){var b=this.$n();if(this._inplace&&this._inplaceout){b.style.width=jq.px(zk(b).revisedWidth(b.offsetWidth))}this.$supers("doBlur_",arguments);if(this._inplace&&this._inplaceout){jq(b).addClass(this.getInplaceCSS());this.onSize();b.style.width=this.getWidth()||""}},afterKeyDown_:function(a){if(this._inplace){jq(this.$n()).toggleClass(this.getInplaceCSS(),a.keyCode==13?null:false)}this.$supers("afterKeyDown_",arguments)},bind_:function(){this.$supers("bind_",arguments);var a=this.$n("btn"),b=this.getInputNode();if(this._inplace){jq(b).addClass(this.getInplaceCSS())}if(a){this._auxb=new zul.Auxbutton(this,a,b);this.domListen_(a,"onClick","_doBtnClick")}this.syncWidth();zWatch.listen({onSize:this,onShow:this});this._pop.setFormat(this.getDateFormat())},unbind_:function(){var a=this.$n("btn");if(a){this._auxb.cleanup();this._auxb=null;this.domUnlisten_(a,"onClick","_doBtnClick")}zWatch.unlisten({onSize:this,onShow:this});this.$supers("unbind_",arguments)},_doBtnClick:function(a){if(!this._disabled){this.setOpen()}a.stop()},onChange:function(a){if(this._pop){this._pop._value=a.data.value}}});zul.db.CalendarPop=zk.$extends(zul.db.Calendar,{$init:function(){this.$supers("$init",arguments);this.listen({onChange:this},-1000)},setFormat:function(b){if(b!=this._fmt){var a=this._fmt;this._fmt=b;if(this.getValue()){this._value=zDateFormat.formatDate(zDateFormat.parseDate(this.getValue(),a),b)}}},close:function(c){var b=this.parent,a=b.$n("pp");if(!a||!zk(a).isVisible()){return}if(this._shadow){this._shadow.hide()}var e=b.getZclass();a.style.display="none";a.className=e+"-pp";jq(a).zk.undoVParent();var d=this.$n("btn");if(d){jq(d).removeClass(e+"-btn-over")}if(!c){jq(b.getInputNode()).focus()}},open:(function(){function a(e){var c=e.$n();if(!c){return}var b=e.$n("pp"),d=e.getInputNode();if(b){zk(b).position(d,"after_start");e._pop.syncShadow();zk(d).focus()}return}return function(){var h=this.parent,e=h.$n(),d=h.$n("pp");if(!e||!d){return}var g=h.getZclass();d.className=e.className+" "+d.className;jq(d).removeClass(g);d.style.width=d.style.height="auto";d.style.position="absolute";d.style.overflow="auto";d.style.display="block";d.style.zIndex="88000";jq(d).zk.makeVParent();if(d.offsetHeight>200){d.style.width="auto"}else{if(d.offsetHeight<10){d.style.height="10px"}}if(d.offsetWidth<e.offsetWidth){d.style.width=e.offsetWidth+"px"}else{var f=jq.innerWidth()-20;if(f<e.offsetWidth){f=e.offsetWidth}if(d.offsetWidth>f){d.style.width=f}}zk(d).position(h.getInputNode(),"after_start");setTimeout(function(){a(h)},150);var c=h.getTimeFormat();if(c){var b=h._tm;b.setVisible(true);b.setFormat(c);b.setValue(h.getValue());b.onShow()}else{h._tm.setVisible(false)}}})(),syncShadow:function(){if(!this._shadow){this._shadow=new zk.eff.Shadow(this.parent.$n("pp"),{left:-4,right:4,top:2,bottom:3,stackup:(zk.useStackup===undefined?zk.ie6_:zk.useStackup)})}this._shadow.sync()},onChange:function(a){var b=this.getTime(),c=this.parent.getValue();if(c){c.setFullYear(b.getFullYear());c.setMonth(b.getMonth());c.setDate(b.getDate())}else{this.parent._value=b}this.parent.getInputNode().value=a.data.value=this.parent.getRawText();this.parent.fire(a.name,a.data);if(this._view=="day"&&a.data.shallClose!==false){this.close();this.parent._inplaceout=true}this.parent.focus();a.stop()},onFloatUp:function(a){if(!zUtl.isAncestor(this.parent,a.origin)){this.close(true)}},bind_:function(){this.$supers("bind_",arguments);zWatch.listen({onFloatUp:this})},unbind_:function(){zWatch.unlisten({onFloatUp:this});if(this._shadow){this._shadow.destroy();this._shadow=null}this.$supers("unbind_",arguments)},_setView:function(a){this.parent._tm.setVisible(a=="day");this.$supers("_setView",arguments)},_choiceData:function(a){var b=a.domTarget;b=b.tagName=="TD"?b:b.parentNode;if(b&&jq(b).hasClass(this.getZclass()+"-disd")){this.close()}else{this.$supers("_choiceData",arguments)}}});zul.db.CalendarTime=zk.$extends(zul.inp.Timebox,{$init:function(){this.$supers("$init",arguments);this.listen({onChanging:this},-1000)},onChanging:function(a){var b=this.coerceFromString_(a.data.value),c=this.parent.getValue();if(c){c.setHours(b.getHours());c.setMinutes(b.getMinutes());c.setSeconds(b.getSeconds())}else{this.parent._value=b}this.parent.getInputNode().value=a.data.value=this.parent.getRawText();this.parent.fire(a.name,a.data);if(this._view=="day"&&a.data.shallClose!==false){this.close();this.parent._inplaceout=true}this.parent.focus();a.stop()}});
zkreg('zul.db.Datebox');zk._m={};
zk._m['default']=function(b){var d=this.getZclass(),c=this.uuid;b.push('<span id="',c,'"',this.domAttrs_({text:true}),'><input id="',c,'-real" class="',d,'-inp" autocomplete="off"',this.textAttrs_()," />",'<span id="',c,'-btn" class="',d,'-btn"');if(!this._buttonVisible){b.push(' style="display:none"')}b.push('><span class="',d,'-img" ></span></span><div id="',c,'-pp" class="',d,'-pp" style="display:none" tabindex="-1">');for(var a=this.firstChild;a;a=a.nextSibling){a.redraw(b)}b.push("</div></span>")};
;zkmld(zk._p.Datebox,zk._m);
}finally{zk.setLoaded(zk._n);}});zk.setLoaded('zul.db',1);